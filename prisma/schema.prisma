generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       String @id @default(cuid())
  email    String @unique
  password String
  role     Role   @default(ADMIN)
}

model Content {
  id       String  @id @default(cuid())
  page     String
  section  String
  title    String?
  content  String
  image    String?
  order    Int     @default(0)
  fontSize String  @default("normal")

  @@unique([page, section])
}

model Notice {
  id        String   @id @default(cuid())
  title     String
  content   String
  important Boolean  @default(false)
  category  String   @default("general")
  status    String   @default("published")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model HealthInfo {
  id        String   @id @default(cuid())
  title     String
  content   String
  category  String
  imageUrl  String?
  createdAt DateTime @default(now())
}

model Gallery {
  id          String   @id @default(cuid())
  title       String
  description String?
  imageUrl    String
  category    String
  altText     String
  createdAt   DateTime @default(now())
}

model MarqueeNotice {
  id        String   @id @default(cuid())
  icon      String
  text      String
  order     Int      @default(0)
  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Treatment {
  id          String            @id @default(cuid())
  title       String
  icon        String
  description String
  features    String
  category    String?
  imageUrl    String?
  order       Int               @default(0)
  active      Boolean           @default(true)
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt
  detail      TreatmentDetail?
}

model FAQ {
  id        String   @id @default(cuid())
  question  String
  answer    String
  order     Int      @default(0)
  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model HospitalContent {
  id        String   @id @default(cuid())
  section   String   @unique
  data      String
  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
}

model AuditLog {
  id         String   @id @default(cuid())
  userId     String
  userEmail  String
  action     String
  entityType String
  entityId   String?
  entityName String?
  changes    String?
  ipAddress  String?
  userAgent  String?
  createdAt  DateTime @default(now())

  @@index([userId])
  @@index([entityType])
  @@index([createdAt])
}

model Popup {
  id             String   @id @default(cuid())
  title          String
  content        String
  imageUrl       String?
  active         Boolean  @default(true)
  showDoNotShow  Boolean  @default(true)
  startDate      DateTime?
  endDate        DateTime?
  order          Int      @default(0)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}

model Doctor {
  id          String   @id @default(cuid())
  name        String
  title       String
  specialty   String
  photoUrl    String?
  education   String
  career      String
  order       Int      @default(0)
  active      Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model HeroSlide {
  id          String   @id @default(cuid())
  imageUrl    String
  title       String
  description String?
  buttonText  String?
  buttonLink  String?
  imageWidth  Int?     // 원본 이미지 너비
  imageHeight Int?     // 원본 이미지 높이
  aspectRatio String?  // 계산된 비율 "16:9", "21:9" 등
  order       Int      @default(0)
  active      Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// 병원 기본 정보 (전역 설정 - Logo, Footer, Contact 통합)
model HospitalInfo {
  id              String   @id @default(cuid())
  // Logo
  logoUrl         String?
  logoAlt         String   @default("병원 로고")
  // Basic Info
  hospitalName    String
  address         String
  phone           String
  fax             String?
  email           String?
  // Business Info
  representative  String?
  businessNumber  String?
  // Map & Location
  mapImageUrl     String?
  kakaoMapUrl     String?
  naverMapUrl     String?
  googleMapUrl    String?
  subwayInfo      String?
  busInfo         String?
  parkingInfo     String?
  // Social Media
  facebookUrl     String?
  instagramUrl    String?
  youtubeUrl      String?
  // Footer
  copyrightText   String   @default("© 2024 병원. All rights reserved.")
  updatedAt       DateTime @updatedAt
  createdAt       DateTime @default(now())
}

// 페이지별 히어로 이미지
model PageHero {
  id          String   @id @default(cuid())
  page        String   @unique // "about", "services", "treatments", "notices"
  imageUrl    String
  title       String
  subtitle    String?
  updatedAt   DateTime @updatedAt
  createdAt   DateTime @default(now())
}

// 인사말 섹션
model GreetingSection {
  id        String   @id @default(cuid())
  imageUrl  String?
  content   String
  signature String
  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
}

// 병원 장비
model Equipment {
  id          String   @id @default(cuid())
  name        String
  description String
  imageUrl    String
  order       Int      @default(0)
  active      Boolean  @default(true)
  updatedAt   DateTime @updatedAt
  createdAt   DateTime @default(now())
}

// 병원 둘러보기
model HospitalTour {
  id        String   @id @default(cuid())
  title     String
  imageUrl  String
  order     Int      @default(0)
  active    Boolean  @default(true)
  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
}

// 진료 과목
model Service {
  id          String   @id @default(cuid())
  name        String
  description String
  icon        String   @default("personal_injury")
  details     String   // JSON array of detail items
  order       Int      @default(0)
  active      Boolean  @default(true)
  updatedAt   DateTime @updatedAt
  createdAt   DateTime @default(now())
}

// 치료법 상세 정보
model TreatmentDetail {
  id                    String   @id @default(cuid())
  treatmentId           String   @unique
  detailedDescription   String   // Rich text
  targetConditions      String   // JSON array
  methodology           String   // Rich text
  benefits              String   // JSON array
  procedureSteps        String   // JSON array
  precautions           String   // Rich text
  faqs                  String   // JSON array: [{question, answer}]
  galleryImages         String   // JSON array: [{imageUrl, caption}]
  updatedAt             DateTime @updatedAt
  createdAt             DateTime @default(now())

  treatment Treatment @relation(fields: [treatmentId], references: [id], onDelete: Cascade)
}

// 진료시간 정보
model ClinicHours {
  id            String   @id @default(cuid())
  weekdayOpen   String   // "09:00"
  weekdayClose  String   // "18:00"
  saturdayOpen  String?  // "09:00"
  saturdayClose String?  // "13:00"
  lunchStart    String?  // "13:00"
  lunchEnd      String?  // "14:00"
  closedDays    String   // "일요일, 공휴일"
  updatedAt     DateTime @updatedAt
  createdAt     DateTime @default(now())
}

// 원장 상세 시간표
model DoctorSchedule {
  id              String   @id @default(cuid())
  doctorId        String
  dayOfWeek       String   // "monday", "tuesday", etc.
  morningStatus   String   // "available", "closed", "note"
  afternoonStatus String   // "available", "closed", "note"
  note            String?  // 특이사항
  updatedAt       DateTime @updatedAt
  createdAt       DateTime @default(now())

  @@unique([doctorId, dayOfWeek])
}

// 페이지별 헤딩
model PageHeading {
  id        String   @id @default(cuid())
  page      String   @unique // "hours", "contact"
  title     String
  subtitle  String?
  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
}

// 페이지별 안내 메시지
model PageNotice {
  id        String   @id @default(cuid())
  page      String   @unique // "hours"
  content   String
  type      String   @default("info") // "info", "warning", "alert"
  active    Boolean  @default(true)
  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
}

// 정보 카드 (공지사항 페이지 등)
model InfoCard {
  id          String   @id @default(cuid())
  page        String   // "notices"
  emoji       String
  title       String
  description String
  order       Int      @default(0)
  active      Boolean  @default(true)
  updatedAt   DateTime @updatedAt
  createdAt   DateTime @default(now())
}

enum Role {
  ADMIN
  STAFF
}
